{"ast":null,"code":"import http from \"./httpService\";\nimport jwtDecode from \"jwt-decode\";\nimport { toast } from \"react-toastify\";\n\nasync function login(email, password) {\n  const {\n    data: jwt\n  } = await http.post(\"/auth\", {\n    email,\n    password\n  });\n  localStorage.setItem(\"token\", jwt);\n}\n\nfunction loginWithJwt(jwt) {\n  localStorage.setItem(\"token\", jwt);\n}\n\nfunction logout() {\n  localStorage.removeItem(\"token\");\n}\n\nasync function getCurrentUser() {\n  try {\n    const {\n      data: users\n    } = await http.get(\"/users\");\n    const jwt = localStorage.getItem(\"token\");\n    const decoded = jwtDecode(jwt);\n    let user;\n\n    for (let i = 0; i < users.length; i++) {\n      if (decoded.user_id && decoded.user_id === users[i].facebookId) {\n        user = users[i];\n      } else if (decoded.sub && users[i].googleId === decoded.sub) {\n        user = users[i];\n      } else if (decoded._id && decoded._id === users[i]._id) {\n        user = users[i];\n      }\n    }\n\n    return user;\n  } catch (err) {\n    toast.error(err.response);\n  }\n}\n\nfunction getJwt() {\n  return localStorage.getItem(\"token\");\n}\n\nexport default {\n  login,\n  loginWithJwt,\n  logout,\n  getCurrentUser,\n  getJwt\n};","map":{"version":3,"sources":["/Users/mojib2014/Desktop/projects/blog-client/src/services/auth.js"],"names":["http","jwtDecode","toast","login","email","password","data","jwt","post","localStorage","setItem","loginWithJwt","logout","removeItem","getCurrentUser","users","get","getItem","decoded","user","i","length","user_id","facebookId","sub","googleId","_id","err","error","response","getJwt"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,eAAjB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,KAAT,QAAsB,gBAAtB;;AAEA,eAAeC,KAAf,CAAqBC,KAArB,EAA4BC,QAA5B,EAAsC;AACpC,QAAM;AAAEC,IAAAA,IAAI,EAAEC;AAAR,MAAgB,MAAMP,IAAI,CAACQ,IAAL,CAAU,OAAV,EAAmB;AAAEJ,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAnB,CAA5B;AAEAI,EAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BH,GAA9B;AACD;;AAED,SAASI,YAAT,CAAsBJ,GAAtB,EAA2B;AACzBE,EAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BH,GAA9B;AACD;;AAED,SAASK,MAAT,GAAkB;AAChBH,EAAAA,YAAY,CAACI,UAAb,CAAwB,OAAxB;AACD;;AAED,eAAeC,cAAf,GAAgC;AAC9B,MAAI;AACF,UAAM;AAAER,MAAAA,IAAI,EAAES;AAAR,QAAkB,MAAMf,IAAI,CAACgB,GAAL,CAAS,QAAT,CAA9B;AAEA,UAAMT,GAAG,GAAGE,YAAY,CAACQ,OAAb,CAAqB,OAArB,CAAZ;AACA,UAAMC,OAAO,GAAGjB,SAAS,CAACM,GAAD,CAAzB;AAEA,QAAIY,IAAJ;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,KAAK,CAACM,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC,UAAIF,OAAO,CAACI,OAAR,IAAmBJ,OAAO,CAACI,OAAR,KAAoBP,KAAK,CAACK,CAAD,CAAL,CAASG,UAApD,EAAgE;AAC9DJ,QAAAA,IAAI,GAAGJ,KAAK,CAACK,CAAD,CAAZ;AACD,OAFD,MAEO,IAAIF,OAAO,CAACM,GAAR,IAAeT,KAAK,CAACK,CAAD,CAAL,CAASK,QAAT,KAAsBP,OAAO,CAACM,GAAjD,EAAsD;AAC3DL,QAAAA,IAAI,GAAGJ,KAAK,CAACK,CAAD,CAAZ;AACD,OAFM,MAEA,IAAIF,OAAO,CAACQ,GAAR,IAAeR,OAAO,CAACQ,GAAR,KAAgBX,KAAK,CAACK,CAAD,CAAL,CAASM,GAA5C,EAAiD;AACtDP,QAAAA,IAAI,GAAGJ,KAAK,CAACK,CAAD,CAAZ;AACD;AACF;;AACD,WAAOD,IAAP;AACD,GAjBD,CAiBE,OAAOQ,GAAP,EAAY;AACZzB,IAAAA,KAAK,CAAC0B,KAAN,CAAYD,GAAG,CAACE,QAAhB;AACD;AACF;;AAED,SAASC,MAAT,GAAkB;AAChB,SAAOrB,YAAY,CAACQ,OAAb,CAAqB,OAArB,CAAP;AACD;;AAED,eAAe;AACbd,EAAAA,KADa;AAEbQ,EAAAA,YAFa;AAGbC,EAAAA,MAHa;AAIbE,EAAAA,cAJa;AAKbgB,EAAAA;AALa,CAAf","sourcesContent":["import http from \"./httpService\";\nimport jwtDecode from \"jwt-decode\";\nimport { toast } from \"react-toastify\";\n\nasync function login(email, password) {\n  const { data: jwt } = await http.post(\"/auth\", { email, password });\n\n  localStorage.setItem(\"token\", jwt);\n}\n\nfunction loginWithJwt(jwt) {\n  localStorage.setItem(\"token\", jwt);\n}\n\nfunction logout() {\n  localStorage.removeItem(\"token\");\n}\n\nasync function getCurrentUser() {\n  try {\n    const { data: users } = await http.get(\"/users\");\n\n    const jwt = localStorage.getItem(\"token\");\n    const decoded = jwtDecode(jwt);\n\n    let user;\n    for (let i = 0; i < users.length; i++) {\n      if (decoded.user_id && decoded.user_id === users[i].facebookId) {\n        user = users[i];\n      } else if (decoded.sub && users[i].googleId === decoded.sub) {\n        user = users[i];\n      } else if (decoded._id && decoded._id === users[i]._id) {\n        user = users[i];\n      }\n    }\n    return user;\n  } catch (err) {\n    toast.error(err.response);\n  }\n}\n\nfunction getJwt() {\n  return localStorage.getItem(\"token\");\n}\n\nexport default {\n  login,\n  loginWithJwt,\n  logout,\n  getCurrentUser,\n  getJwt,\n};\n"]},"metadata":{},"sourceType":"module"}